---
import Layout from "../../layouts/Layout.astro";
import { Navbar } from "@/components/layout/Navbar";
import { MobileMenu } from "@/components/layout/MobileMenu";
import { AnalysisDetailContainer } from "@/components/analysis/AnalysisDetailContainer";

export const prerender = false;

const { id } = Astro.params;

// Validate UUID format
const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
if (!id || !uuidRegex.test(id)) {
  return Astro.redirect("/");
}
---

<Layout title="Szczegóły analizy | Diff Explainer">
  <div class="relative flex min-h-screen flex-col">
    <Navbar client:load />

    <main class="flex-1">
      <div class="container mx-auto px-4 py-6 max-w-4xl">
        <AnalysisDetailContainer client:load analysisId={id} />
      </div>
    </main>

    <MobileMenu client:load />
  </div>
</Layout>
